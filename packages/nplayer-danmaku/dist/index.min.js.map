{"version":3,"sources":["webpack://NPlayerDanmaku/webpack/universalModuleDefinition","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/scss/index.scss?8c61","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/ts/utils.ts","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/ts/danmaku/bullet.ts","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/ts/danmaku/index.ts","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/ts/send-box.ts","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/ts/setting.ts","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/ts/main.ts","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/scss/index.scss","webpack://NPlayerDanmaku/./node_modules/css-loader/dist/runtime/api.js","webpack://NPlayerDanmaku/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://NPlayerDanmaku/webpack/bootstrap","webpack://NPlayerDanmaku/webpack/startup","webpack://NPlayerDanmaku/webpack/runtime/compat get default export","webpack://NPlayerDanmaku/webpack/runtime/define property getters","webpack://NPlayerDanmaku/webpack/runtime/hasOwnProperty shorthand","webpack://NPlayerDanmaku/webpack/runtime/make namespace object"],"names":["root","factory","exports","module","define","amd","this","options","isDefaultColor","color","toLowerCase","Timer","_prevPauseTime","_pausedTime","_paused","now","Date","play","pause","storageKey","SEND_SETTINGS","SEND","MODE","SCROLL","TOP","BOTTOM","COLOR","COLOUR","DANMAKU_SETTINGS","ONOFF","RESTORE","BLOCK_BT","OPACITY","DISPLAY_A","HALF_S","FULL_S","DANMAKU_S","SLOW","FAST","FONTSIZE","SMALL","UNLIMITED","BOTTOM_TT","trans","itemClass","Bullet","container","danmaku","opts","setting","width","left","length","startAt","showAt","endAt","speed","track","ended","end","element","removeEventListener","clearTimeout","centerTimer","style","cssText","className","hide","recycleBullet","appendChild","document","createElement","init","textContent","text","type","isMe","classList","add","fontSize","fontsize","addEventListener","getBoundingClientRect","danmakuWidth","prev","speedScale","duration","s","maxSpeed","t","updateScrollY","transition","transform","pos","setTimeout","show","paused","trackHeight","bottomUp","top","bottom","visibility","time","utils","defaultOptions","disable","blocked","fontsizeScale","opacity","area","unlimited","colors","items","zIndex","persistOptions","discard","Danmaku","player","_opts","enabled","bulletPool","aliveBullets","Set","scrollBullets","topBullets","bottomBullets","prevPauseTime","fire","playing","resume","item","currentTime","inc","min","max","l","shouldDiscard","insert","onSeeked","clearScreen","forEach","bullet","loading","showing","run","optStr","window","localStorage","getItem","JSON","parse","error","getStorageOptions","Player","_utils","$","addDisposable","String","enable","on","updateTrack","rect","playbackRate","pop","shortest","i","list","includes","Math","floor","height","setItem","stringify","setStorageOptions","push","delete","undefined","getShortestTrack","canDiscard","force","createBullet","getEmptyTrack","emit","addItem","index","splice","concat","storeOptions","scale","b","v","filter","updateOpacity","updateFontsize","Array","from","off","removeNode","dispose","DanmakuSendBox","typeCBs","currentType","onTypeChange","scroll","update","ev","getEventPath","popover","tooltip","send","value","inputElement","colorInputElement","components","I18n","addDisposableListener","createSvg","settingElement","Tooltip","Popover","sendElement","colorItem","panelElement","rowElement","Checkbox","html","checked","change","updateColor","colorElement","el","target","dataset","c","background","altKey","ctrlKey","metaKey","shiftKey","keyCode","which","control","require","release","id","danmakuSendBoxControlItem","DanmakuSetting","clamp","addClass","row","Switch","resetBtn","resetOptions","scrollCB","topCB","bottomCB","colorCB","opacitySlider","Slider","stops","areaSlider","step","updateArea","speedSlider","updateSpeed","fontsizeSlider","unlimitedCB","updateUnlimited","bottomUpCB","updateBottomUp","0.25","0.5","0.75","1","danmakuSettingControlItem","Plugin","registerControlItem","autoInsertControl","controls","findIndex","___CSS_LOADER_EXPORT___","cssWithMappingToString","toString","map","content","join","modules","mediaQuery","dedupe","alreadyImportedModules","_i","memo","isOldIE","Boolean","all","atob","getTarget","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","e","stylesInDom","getIndexByIdentifier","identifier","result","modulesToDom","idCountMap","identifiers","base","count","obj","css","media","sourceMap","references","updater","addStyle","insertStyleElement","attributes","nonce","Object","keys","key","setAttribute","Error","textStore","replaceText","replacement","applyToSingletonTag","remove","styleSheet","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","btoa","unescape","encodeURIComponent","firstChild","singleton","singletonCounter","styleIndex","bind","parentNode","removeStyleElement","newObj","lastIdentifiers","newList","prototype","call","newLastIdentifiers","_index","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","get","prop","hasOwnProperty","r","Symbol","toStringTag"],"mappings":"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","file":"index.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"NPlayerDanmaku\"] = factory();\n\telse\n\t\troot[\"NPlayerDanmaku\"] = factory();\n})(this, function() {\nreturn ","import api from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[1].use[1]!../../../../node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[1].use[2]!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[1].use[3]!./index.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import { DanmakuOptions } from './danmaku';\n\nexport function isDefaultColor(color: string): boolean {\n  if (!color) return true;\n  color = color.toLowerCase();\n  return color === '#fff' || color === '#ffffff';\n}\n\nexport const Timer = {\n  _prevPauseTime: 0,\n  _pausedTime: 0,\n  _paused: false,\n\n  now() {\n    return ((this._paused ? this._prevPauseTime : Date.now()) - this._pausedTime) / 1000;\n  },\n\n  play() {\n    if (!this._paused) return;\n    this._pausedTime += (Date.now() - this._prevPauseTime);\n    this._paused = false;\n  },\n\n  pause() {\n    if (this._paused) return;\n    this._prevPauseTime = Date.now();\n    this._paused = true;\n  },\n};\n\nconst storageKey = 'nplayer:danmaku';\nexport function getStorageOptions(): DanmakuOptions | undefined {\n  try {\n    const optStr = window.localStorage.getItem(storageKey);\n    if (!optStr) return;\n    return JSON.parse(optStr);\n  } catch (error) {\n    // ignore\n  }\n}\nexport function setStorageOptions(opts: DanmakuOptions) {\n  try {\n    window.localStorage.setItem(storageKey, JSON.stringify(opts));\n  } catch (error) {\n    // ignore\n  }\n}\n\nexport const SEND_SETTINGS = 'Send settings';\nexport const SEND = 'Send';\nexport const MODE = 'Mode';\nexport const SCROLL = 'Scroll';\nexport const TOP = 'Top';\nexport const BOTTOM = 'Bottom';\nexport const COLOR = 'Color';\nexport const COLOUR = 'Color';\nexport const DANMAKU_SETTINGS = 'Danmaku settings';\nexport const ONOFF = 'On/Off';\nexport const RESTORE = 'Restore settings';\nexport const BLOCK_BT = 'Block by type';\nexport const OPACITY = 'Opacity &nbsp;';\nexport const DISPLAY_A = 'Area &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';\nexport const HALF_S = 'Half';\nexport const FULL_S = 'Full';\nexport const DANMAKU_S = 'Speed &nbsp;&nbsp;&nbsp;';\nexport const SLOW = 'Slow';\nexport const FAST = 'Fast';\nexport const FONTSIZE = 'Font size';\nexport const SMALL = 'Small';\nexport const BIG = 'Big';\nexport const UNLIMITED = 'Unlimited';\nexport const BOTTOM_TT = 'Bottom to top';\n\nexport const trans = {\n  [SEND_SETTINGS]: '发送设置',\n  [SEND]: '发送',\n  [MODE]: '模式',\n  [SCROLL]: '滚动',\n  [TOP]: '顶部',\n  [BOTTOM]: '底部',\n  [COLOR]: '颜色',\n  [COLOUR]: '彩色',\n  [DANMAKU_SETTINGS]: '弹幕设置',\n  [ONOFF]: '开/关',\n  [RESTORE]: '恢复默认设置',\n  [BLOCK_BT]: '按类型屏蔽',\n  [OPACITY]: '不透明度',\n  [DISPLAY_A]: '显示区域',\n  [HALF_S]: '半屏',\n  [FULL_S]: '全屏',\n  [DANMAKU_S]: '弹幕速度',\n  [SLOW]: '慢',\n  [FAST]: '快',\n  [FONTSIZE]: '字体大小',\n  [SMALL]: '小',\n  [BIG]: '大',\n  [UNLIMITED]: '不限弹幕',\n  [BOTTOM_TT]: '从下到上',\n};\n","import type { Danmaku } from '.';\nimport { Timer } from '../utils';\n\nexport interface BulletOption {\n  color?: string;\n  text: string;\n  time: number;\n  type?: 'top' | 'bottom' | 'scroll';\n  isMe?: boolean;\n  force?: boolean;\n}\n\nexport interface BulletSetting {\n  track: number;\n  // eslint-disable-next-line no-use-before-define\n  prev?: Bullet;\n}\n\nconst itemClass = 'nplayer_danmaku_item';\n\nexport class Bullet {\n  readonly element: HTMLElement;\n\n  width = 0;\n\n  left = 0;\n\n  length = 0; // w + l\n\n  startAt = 0;\n\n  showAt = 0;\n\n  endAt = 0;\n\n  speed = 0;\n\n  track = 0;\n\n  type!: string;\n\n  ended = false;\n\n  color = '';\n\n  private centerTimer!: any;\n\n  constructor(container: HTMLElement, private danmaku: Danmaku, opts: BulletOption, setting: BulletSetting) {\n    this.element = container.appendChild(document.createElement('div'));\n    this.element.className = itemClass;\n    this.init(opts, setting);\n  }\n\n  init(opts: BulletOption, setting: BulletSetting): this {\n    this.element.textContent = opts.text;\n    this.type = opts.type || 'scroll';\n    this.track = setting.track;\n    if (opts.color) this.element.style.color = this.color = opts.color;\n    if (opts.isMe) this.element.classList.add('nplayer_danmaku_item-me');\n    const style = this.element.style;\n    style.fontSize = `${this.danmaku.fontsize}px`;\n\n    this.startAt = Timer.now();\n\n    if (this.type === 'scroll') {\n      this.element.addEventListener('transitionend', this.end);\n      this.width = this.element.getBoundingClientRect().width + 20;\n      const danmakuWidth = this.danmaku.width;\n      const prev = setting.prev;\n      this.left = danmakuWidth;\n      this.speed = this.danmaku.speedScale * (danmakuWidth + this.width) / this.danmaku.opts.duration;\n\n      if (prev && !prev.ended) {\n        const s = (prev.length - danmakuWidth) - (this.startAt - prev.startAt) * prev.speed;\n        if (s >= 0) {\n          this.speed = prev.speed;\n          this.left += s;\n        } else {\n          const maxSpeed = this.danmaku.width / (prev.endAt - this.startAt);\n          if (this.speed > maxSpeed) this.speed = maxSpeed;\n        }\n      }\n\n      this.length = this.left + this.width;\n      const t = this.length / this.speed;\n      this.showAt = this.startAt + (this.length - danmakuWidth) / this.speed;\n      this.endAt = this.startAt + t;\n\n      this.updateScrollY();\n      style.left = `${this.left}px`;\n      style.transition = `transform ${t}s linear`;\n      style.transform = `translate3d(-${this.length}px,0,0)`;\n    } else {\n      style[this.type as any] = this.pos();\n      this.element.classList.add('nplayer_danmaku_item-center');\n      const duration = this.danmaku.speedScale * this.danmaku.opts.duration;\n      this.endAt = this.startAt + duration;\n      this.centerTimer = setTimeout(this.end, duration * 1000);\n    }\n\n    this.ended = false;\n    this.show();\n\n    if (this.danmaku.paused) this.pause(this.startAt);\n\n    return this;\n  }\n\n  private pos(): string {\n    return `${this.track * this.danmaku.trackHeight + 2}px`;\n  }\n\n  updateScrollY(bottomUp = this.danmaku.opts.bottomUp) {\n    if (this.type !== 'scroll') return;\n    const style = this.element.style;\n    style.top = style.bottom = '';\n    style[bottomUp ? 'bottom' : 'top'] = this.pos();\n  }\n\n  end = () => {\n    this.element.removeEventListener('transitionend', this.end);\n    clearTimeout(this.centerTimer);\n    this.element.style.cssText = '';\n    this.color = '';\n    this.element.className = itemClass;\n    this.ended = true;\n    this.hide();\n    this.danmaku.recycleBullet(this);\n  }\n\n  show() {\n    this.element.style.visibility = 'visible';\n  }\n\n  hide() {\n    this.element.style.visibility = 'hidden';\n  }\n\n  pause(time: number): void {\n    if (this.type === 'scroll') {\n      const style = this.element.style;\n      style.transition = 'transform 0s linear';\n      style.transform = `translate3d(-${(time - this.startAt) * this.speed}px,0,0)`;\n    } else {\n      clearTimeout(this.centerTimer);\n    }\n  }\n\n  run(time: number): void {\n    if (this.type === 'scroll') {\n      const style = this.element.style;\n      style.transition = `transform ${this.endAt - time}s linear`;\n      style.transform = `translate3d(-${this.length}px,0,0)`;\n    } else {\n      this.centerTimer = setTimeout(this.end, (this.endAt - time) * 1000);\n    }\n  }\n}\n","import type { Disposable, Player } from 'nplayer';\nimport {\n  getStorageOptions, isDefaultColor, setStorageOptions, Timer,\n} from '../utils';\nimport { Bullet, BulletOption, BulletSetting } from './bullet';\n\nexport interface DanmakuOptions {\n  disable?: boolean;\n  blocked?: Array<'scroll' | 'top' | 'bottom' | 'color'>;\n  fontsize?: number;\n  fontsizeScale?: number;\n  opacity?: number;\n  speed?: number;\n  area?: 0.25 | 0.5 | 0.75 | 1;\n  unlimited?: boolean;\n  bottomUp?: boolean;\n  colors?: string[];\n  duration?: number;\n  items?: BulletOption[];\n  zIndex?: number;\n  persistOptions: boolean;\n  discard?: (b: BulletOption) => boolean;\n}\n\nexport const defaultOptions = (): Required<DanmakuOptions> => ({\n  disable: false,\n  blocked: [],\n  fontsize: 24,\n  fontsizeScale: 1,\n  opacity: 1,\n  speed: 1,\n  area: 0.5,\n  unlimited: false,\n  bottomUp: false,\n  colors: ['#FE0302', '#FF7204', '#FFAA02', '#FFD302', '#FFFF00', '#A0EE00', '#00CD00', '#019899', '#4266BE', '#89D5FF', '#CC0273', '#222222', '#9B9B9B', '#FFFFFF'],\n  duration: 5,\n  items: [],\n  zIndex: 5,\n  persistOptions: false,\n  discard() { return false; },\n});\n\nexport class Danmaku implements Disposable {\n  element: HTMLElement;\n\n  opts: Required<DanmakuOptions>;\n\n  enabled = false;\n\n  paused = false;\n\n  track = 0;\n\n  trackHeight = 0;\n\n  private bulletPool: Bullet[] = [];\n\n  private aliveBullets: Set<Bullet> = new Set();\n\n  private scrollBullets: (Bullet | undefined)[] = [];\n\n  private topBullets: number[] = [];\n\n  private bottomBullets: number[] = [];\n\n  private items: BulletOption[] = [];\n\n  private pos = 0;\n\n  private prevPauseTime = 0;\n\n  constructor(private player: Player, private _opts?: DanmakuOptions) {\n    this.opts = { ...defaultOptions(), ...getStorageOptions(), ..._opts };\n\n    const { $, addDisposable } = player.Player._utils;\n    this.element = player.element.appendChild($('.danmaku_screen'));\n    this.element.style.zIndex = String(this.opts.zIndex);\n\n    this.items = this.opts.items;\n\n    if (!this.opts.disable) this.enable();\n\n    addDisposable(this, player.on('mounted', () => {\n      this.updateTrack();\n    }));\n\n    addDisposable(player, this);\n  }\n\n  get width(): number {\n    return this.player.rect.width;\n  }\n\n  get currentTime(): number {\n    return this.player.currentTime;\n  }\n\n  get playbackRate(): number {\n    return this.player.playbackRate;\n  }\n\n  get fontsize(): number {\n    return this.opts.fontsize * this.opts.fontsizeScale;\n  }\n\n  get speedScale(): number {\n    return this.playbackRate * this.opts.speed;\n  }\n\n  private createBullet(item: BulletOption, setting: BulletSetting): Bullet {\n    let bullet = this.bulletPool.pop();\n    if (bullet) {\n      bullet.init(item, setting);\n    } else {\n      bullet = new Bullet(this.element, this, item, setting);\n    }\n    this.aliveBullets.add(bullet);\n    return bullet;\n  }\n\n  private getShortestTrack(): [number, Bullet | undefined] {\n    let shortest = this.scrollBullets[0];\n    if (!shortest || shortest.ended) return [0] as any;\n    for (let i = 1, item; i < this.track; ++i) {\n      item = this.scrollBullets[i];\n      if (!item || item.ended) return [i] as any;\n      if (shortest.showAt > item.showAt) shortest = item;\n    }\n    return [shortest.track, shortest];\n  }\n\n  private getEmptyTrack(time: number, list: number[]): number {\n    for (let i = 0; i < this.track; ++i) {\n      if (!list[i] || list[i] <= time) return i;\n    }\n    return -1;\n  }\n\n  private shouldDiscard(item: BulletOption): boolean {\n    if (this.opts.blocked.includes(item.type || 'scroll')) return true;\n    if (this.opts.discard(item)) return true;\n    if (!item.color || !this.opts.blocked.includes('color')) return false;\n    return !isDefaultColor(item.color);\n  }\n\n  private fire = () => {\n    if (!this.enabled || !this.player.playing) return;\n    if (this.paused) this.resume();\n    const currentTime = this.currentTime;\n    const inc = this.opts.unlimited ? 0.5 : 1;\n    const min = currentTime - inc;\n    const max = currentTime + inc;\n    let item: BulletOption;\n    const time = Timer.now();\n    for (let l = this.items.length; this.pos < l; this.pos++) {\n      item = this.items[this.pos];\n      if (item.time < min) continue;\n      if (item.time > max) break;\n      if (this.shouldDiscard(item)) continue;\n      if (!this.insert(item, time)) break;\n    }\n  }\n\n  private updateTrack(): void {\n    this.trackHeight = this.fontsize + 5;\n    this.track = Math.floor(this.player.rect.height * this.opts.area / this.trackHeight);\n  }\n\n  private onSeeked = () => {\n    this.clearScreen();\n    this.pos = 0;\n  }\n\n  private storeOptions() {\n    if (this.opts.persistOptions) {\n      const opts = this.opts;\n      setStorageOptions({\n        blocked: opts.blocked,\n        fontsizeScale: opts.fontsizeScale,\n        opacity: opts.opacity,\n        speed: opts.speed,\n        area: opts.area,\n        unlimited: opts.unlimited,\n        bottomUp: opts.bottomUp,\n      } as DanmakuOptions);\n    }\n  }\n\n  recycleBullet(bullet: Bullet): void {\n    this.bulletPool.push(bullet);\n    this.aliveBullets.delete(bullet);\n    if (bullet.type === 'scroll' && this.scrollBullets[bullet.track] === bullet) this.scrollBullets[bullet.track] = undefined;\n  }\n\n  insert(item: BulletOption, time: number): boolean {\n    if (!item.type || item.type === 'scroll') {\n      const [track, bullet] = this.getShortestTrack();\n      const canDiscard = !item.force && bullet && bullet.showAt > (time + 2);\n      if (canDiscard && !this.opts.unlimited) return false;\n      this.scrollBullets[track] = this.createBullet(item, { track, prev: canDiscard ? undefined : bullet });\n      return true;\n    }\n\n    const list = item.type === 'top' ? this.topBullets : this.bottomBullets;\n    let track = this.getEmptyTrack(time, list);\n    track = track === -1 && item.force ? 0 : track;\n    if (track !== -1) {\n      list[track] = this.createBullet(item, { track }).endAt;\n      return true;\n    }\n    return false;\n  }\n\n  send(opts: BulletOption): void {\n    if (opts.time == null) opts.time = this.currentTime;\n    opts = { isMe: true, force: true, ...opts };\n    this.player.emit('danmaku-send', opts);\n    const i = this.addItem(opts);\n    if (this.pos > i) {\n      this.insert(opts, Timer.now());\n    }\n  }\n\n  pause = () => {\n    this.prevPauseTime = Timer.now();\n    Timer.pause();\n    this.aliveBullets.forEach((bullet) => bullet.pause(this.prevPauseTime));\n    this.paused = true;\n  }\n\n  resume = () => {\n    if (!this.player.playing || this.player.loading.showing) {\n      return;\n    }\n\n    Timer.play();\n    this.aliveBullets.forEach((bullet) => bullet.run(this.prevPauseTime));\n    this.paused = false;\n  }\n\n  getItems(): BulletOption[] {\n    return this.items;\n  }\n\n  addItem(opts: BulletOption): number {\n    if (opts.time == null) return -1;\n    let index = 0;\n    for (let i = 0, l = this.items.length; i < l; i++) {\n      if (this.items[i].time > opts.time) {\n        index = i;\n        break;\n      }\n    }\n\n    this.items.splice(index, 0, opts);\n    return index;\n  }\n\n  appendItems(items: BulletOption[]): void {\n    this.items = this.items.concat(items);\n  }\n\n  resetItems(items: BulletOption[]): void {\n    this.items = items;\n    this.pos = 0;\n  }\n\n  updateOpacity(opacity = this.opts.opacity): void {\n    this.element.style.opacity = String(opacity);\n    this.storeOptions();\n  }\n\n  updateFontsize(scale = this.opts.fontsizeScale): void {\n    this.opts.fontsizeScale = scale;\n    this.updateTrack();\n    this.storeOptions();\n  }\n\n  updateArea(area: Required<DanmakuOptions>['area']): void {\n    if (![0.25, 0.5, 0.75, 1].includes(area)) return;\n    this.opts.area = area;\n    this.updateTrack();\n    this.storeOptions();\n  }\n\n  updateUnlimited(unlimited: boolean): void {\n    this.opts.unlimited = unlimited;\n    this.storeOptions();\n  }\n\n  updateBottomUp(bottomUp: boolean): void {\n    this.opts.bottomUp = bottomUp;\n    this.aliveBullets.forEach((b) => b.updateScrollY(bottomUp));\n    this.storeOptions();\n  }\n\n  updateSpeed(v: number): void {\n    this.opts.speed = v;\n    this.storeOptions();\n  }\n\n  blockType(type: Required<DanmakuOptions>['blocked'][0]): void {\n    if (this.opts.blocked.includes(type)) return;\n    this.opts.blocked.push(type);\n    this.aliveBullets.forEach((b) => {\n      if (b.type === type || (type === 'color' && !isDefaultColor(b.color))) {\n        b.hide();\n      }\n    });\n    this.storeOptions();\n  }\n\n  allowType(type: Parameters<Danmaku['blockType']>[0]): void {\n    this.opts.blocked = this.opts.blocked.filter((t) => t !== type);\n    this.aliveBullets.forEach((b) => {\n      if (b.type === type || (type === 'color' && !isDefaultColor(b.color))) {\n        b.show();\n      }\n    });\n    this.storeOptions();\n  }\n\n  resetOptions(): void {\n    this.opts = { ...defaultOptions(), ...this._opts };\n    this.opts.blocked = [];\n    this.updateOpacity();\n    this.updateFontsize();\n    this.storeOptions();\n  }\n\n  clearScreen() {\n    Array.from(this.aliveBullets).forEach((b) => b.end());\n    this.topBullets = [];\n    this.bottomBullets = [];\n  }\n\n  enable(): void {\n    if (this.enabled) return;\n    this.enabled = true;\n    this.player.on('time-update', this.fire);\n    this.player.on('pause', this.pause);\n    this.player.on('ended', this.pause);\n    this.player.on('play', this.resume);\n    this.player.on('seeked', this.onSeeked);\n    this.player.on('loading-show', this.pause);\n    this.player.on('loading-hide', this.resume);\n  }\n\n  disable(): void {\n    this.enabled = false;\n    this.clearScreen();\n    this.player.off('time-update', this.fire);\n    this.player.off('pause', this.pause);\n    this.player.off('ended', this.pause);\n    this.player.off('play', this.resume);\n    this.player.off('seeked', this.onSeeked);\n    this.player.off('loading-show', this.pause);\n    this.player.off('loading-hide', this.resume);\n  }\n\n  dispose(): void {\n    if (!this.player) return;\n    this.disable();\n    this.player.Player._utils.removeNode(this.element);\n    this.player.Player._utils.dispose(this);\n    this.player = null!;\n    this.bulletPool = null!;\n    this.aliveBullets = null!;\n    this.scrollBullets = null!;\n    this.topBullets = null!;\n    this.bottomBullets = null!;\n    this.items = null!;\n    this.element = null!;\n    this.opts = null!;\n  }\n}\n","import type {\n  Checkbox,\n  ControlItem,\n  Player, Popover, Tooltip,\n} from 'nplayer';\nimport { BulletOption } from './danmaku/bullet';\nimport {\n  BOTTOM, COLOR, isDefaultColor, MODE, SCROLL, SEND, SEND_SETTINGS, TOP,\n} from './utils';\n\nlet utils: Player['Player']['_utils'];\n\nclass DanmakuSendBox implements ControlItem {\n  static readonly id = 'danmaku';\n\n  element: HTMLElement;\n\n  readonly tooltip: Tooltip;\n\n  private readonly popover: Popover;\n\n  private readonly inputElement: HTMLInputElement;\n\n  private readonly sendElement: HTMLElement;\n\n  private readonly colorInputElement: HTMLInputElement;\n\n  private readonly colorElement: HTMLElement;\n\n  private readonly typeCBs: Record<Required<BulletOption>['type'], Checkbox> = {} as any;\n\n  private currentType = 'scroll';\n\n  constructor(private player: Player) {\n    const { _utils, components, I18n } = player.Player;\n    utils = _utils;\n    const {\n      $, addDisposableListener, addDisposable, createSvg,\n    } = utils;\n\n    this.element = $('.danmaku_send');\n    const settingElement = this.element.appendChild($());\n    settingElement.appendChild(createSvg('icon', 'M9.62 14L12 7.67 14.37 14M11 5L5.5 19h2.25l1.12-3h6.25l1.13 3h2.25L13 5h-2z'));\n    this.tooltip = addDisposable(this, new components.Tooltip(settingElement, I18n.t(SEND_SETTINGS)));\n    this.popover = addDisposable(this, new components.Popover(settingElement, undefined, undefined, true));\n    this.inputElement = this.element.appendChild($('input'));\n    this.sendElement = this.element.appendChild($('.danmaku_send_btn', undefined, I18n.t(SEND)));\n\n    const row = () => $('.flex.align-center.danmaku_row');\n    const panelElement = this.popover.panelElement;\n    let rowElement = $('.danmaku_row');\n    panelElement.appendChild(rowElement);\n    rowElement.appendChild($(undefined, undefined, I18n.t(MODE)));\n    rowElement = rowElement.appendChild($('.flex.align-center'));\n    this.typeCBs.scroll = addDisposable(this, new components.Checkbox(rowElement, { html: I18n.t(SCROLL), checked: true, change: this.onTypeChange('scroll') }));\n    this.typeCBs.top = addDisposable(this, new components.Checkbox(rowElement, { html: I18n.t(TOP), change: this.onTypeChange('top') }));\n    this.typeCBs.bottom = addDisposable(this, new components.Checkbox(rowElement, { html: I18n.t(BOTTOM), change: this.onTypeChange('bottom') }));\n    rowElement = row();\n    rowElement = $('.danmaku_row');\n    panelElement.appendChild(rowElement);\n    rowElement.appendChild($(undefined, undefined, I18n.t(COLOR)));\n    rowElement = rowElement.appendChild($('.danmaku_color_row'));\n    this.colorInputElement = rowElement.appendChild($('input'));\n    addDisposableListener(this, this.colorInputElement, 'input', () => {\n      this.updateColor(this.colorInputElement.value);\n    });\n    this.colorElement = rowElement.appendChild($('.danmaku_color_preview'));\n    rowElement = $('.danmaku_colors');\n    addDisposableListener(this, rowElement, 'click', ({ target }: MouseEvent) => {\n      const el = target as HTMLElement;\n      if (el && el.dataset.value) {\n        this.updateColor(el.dataset.value);\n      }\n    });\n    let colorItem;\n    player.danmaku.opts.colors.forEach((c) => {\n      colorItem = $('.danmaku_color');\n      colorItem.style.background = c;\n      colorItem.dataset.value = c;\n      rowElement.appendChild(colorItem);\n    });\n    panelElement.appendChild(rowElement);\n\n    addDisposableListener(this, settingElement, 'click', this.show);\n    addDisposableListener(this, this.inputElement, 'keypress', (ev: KeyboardEvent) => {\n      if (ev.altKey || ev.ctrlKey || ev.metaKey || ev.shiftKey) return;\n      const code = ev.keyCode || ev.which;\n      if (code !== 13) return;\n      this.send();\n    });\n    addDisposableListener(this, this.inputElement, 'focus', () => player.control.require());\n    addDisposableListener(this, this.inputElement, 'blur', () => player.control.release());\n    addDisposableListener(this, this.sendElement, 'click', this.send);\n\n    this.updateColor('#FFFFFF');\n  }\n\n  private onTypeChange = (type: Required<BulletOption>['type']) => () => {\n    this.currentType = type;\n    this.typeCBs.scroll.update(false);\n    this.typeCBs.top.update(false);\n    this.typeCBs.bottom.update(false);\n    this.typeCBs[type].update(true);\n  }\n\n  updateColor(v: string) {\n    this.colorInputElement.value = v;\n    this.colorElement.style.background = v;\n    this.inputElement.style.color = v;\n  }\n\n  show = (ev?: MouseEvent) => {\n    if (ev && utils.getEventPath(ev).includes(this.popover.element)) return;\n    this.tooltip.hide();\n    this.popover.show();\n  }\n\n  send = () => {\n    const value = this.inputElement.value;\n    if (!value) return;\n    this.inputElement.value = '';\n    const bullet: BulletOption = {\n      text: value,\n      time: this.player.currentTime,\n      type: this.currentType as any,\n      color: isDefaultColor(value) ? undefined : this.colorInputElement.value,\n    };\n    this.player.danmaku.send(bullet);\n  }\n\n  dispose() {\n    if (!this.player) return;\n    utils.dispose(this);\n    utils.removeNode(this.element);\n    this.player = null!;\n    this.element = null!;\n  }\n}\n\nconst danmakuSendBoxControlItem = (player: Player) => new DanmakuSendBox(player);\ndanmakuSendBoxControlItem.id = 'danmaku';\nexport { danmakuSendBoxControlItem };\n","import type {\n  Player, Popover, Tooltip, Checkbox, Slider, ControlItem,\n} from 'nplayer';\nimport {\n  BIG, BLOCK_BT, BOTTOM, BOTTOM_TT, COLOUR, DANMAKU_S, DANMAKU_SETTINGS, DISPLAY_A, FAST, FONTSIZE,\n  FULL_S, HALF_S, ONOFF, OPACITY, RESTORE, SCROLL, SLOW, SMALL, TOP, UNLIMITED,\n} from './utils';\n\nclass DanmakuSetting implements ControlItem {\n  readonly element: HTMLElement;\n\n  readonly tooltip: Tooltip;\n\n  private readonly popover: Popover;\n\n  private scrollCB!: Checkbox;\n\n  private topCB!: Checkbox;\n\n  private bottomCB!: Checkbox;\n\n  private colorCB!: Checkbox;\n\n  private unlimitedCB!: Checkbox;\n\n  private bottomUpCB!: Checkbox;\n\n  private opacitySlider!: Slider;\n\n  private areaSlider!: Slider;\n\n  private speedSlider!: Slider;\n\n  private fontsizeSlider!: Slider;\n\n  constructor(private player: Player) {\n    const { _utils, components, I18n } = player.Player;\n    const {\n      $, clamp, addDisposableListener, addDisposable, createSvg,\n    } = _utils;\n\n    this.element = $();\n    this.element.appendChild(createSvg('icon', 'M9 21v2H7v-2h2m4 0v2h-2v-2h2m4 0v2h-2v-2h2M2 19V3h20v16m-11-7H9v2h2v-2m8 0h-6v2h6v-2M7 8H5v2h2V8m12 0H9v2h10V8z'));\n    this.tooltip = addDisposable(this, new components.Tooltip(this.element, I18n.t(DANMAKU_SETTINGS)));\n    this.popover = addDisposable(this, new components.Popover(this.element));\n\n    addDisposableListener(this, this.element, 'click', this.show);\n\n    const panelElement = this.popover.panelElement;\n    _utils.addClass(panelElement, 'danmaku_setting');\n\n    player.on('mounted', () => {\n      const row = () => $('.flex.align-center.danmaku_row');\n\n      let rowElement = row();\n      rowElement.appendChild($('.danmaku_onoff_label', undefined, I18n.t(ONOFF)));\n      addDisposable(this, new components.Switch(rowElement, player.danmaku.enabled, (v) => player.danmaku[v ? 'enable' : 'disable']()));\n      const resetBtn = rowElement.appendChild($('.danmaku_reset', undefined, I18n.t(RESTORE)));\n      addDisposableListener(this, resetBtn, 'click', () => {\n        player.danmaku.resetOptions();\n        this.update();\n      });\n      panelElement.appendChild(rowElement);\n      rowElement = $('.danmaku_row');\n      panelElement.appendChild(rowElement);\n      rowElement.appendChild($(undefined, undefined, I18n.t(BLOCK_BT)));\n      rowElement = rowElement.appendChild($('.flex.align-center'));\n      this.scrollCB = addDisposable(this, new components.Checkbox(rowElement, {\n        html: I18n.t(SCROLL),\n        change(v) {\n          player.danmaku[v ? 'blockType' : 'allowType']('scroll');\n        },\n      }));\n      this.topCB = addDisposable(this, new components.Checkbox(rowElement, {\n        html: I18n.t(TOP),\n        change(v) {\n          player.danmaku[v ? 'blockType' : 'allowType']('top');\n        },\n      }));\n      this.bottomCB = addDisposable(this, new components.Checkbox(rowElement, {\n        html: I18n.t(BOTTOM),\n        change(v) {\n          player.danmaku[v ? 'blockType' : 'allowType']('bottom');\n        },\n      }));\n      this.colorCB = addDisposable(this, new components.Checkbox(rowElement, {\n        html: I18n.t(COLOUR),\n        change(v) {\n          player.danmaku[v ? 'blockType' : 'allowType']('color');\n        },\n      }));\n      rowElement = row();\n      rowElement.appendChild($(undefined, undefined, I18n.t(OPACITY)));\n      this.opacitySlider = addDisposable(this, new components.Slider(rowElement, {\n        stops: [{ value: 0, html: '10%' }, { value: 1, html: '100%' }],\n        change(value) {\n          player.danmaku.updateOpacity(clamp(value + 0.1, 0.1, 1));\n        },\n      }, player));\n      panelElement.appendChild(rowElement);\n      rowElement = row();\n      rowElement.appendChild($(undefined, undefined, I18n.t(DISPLAY_A)));\n      this.areaSlider = addDisposable(this, new components.Slider(rowElement, {\n        stops: [{ value: 0, html: '1/4' }, { value: 0.33, html: I18n.t(HALF_S) }, { value: 0.66, html: '3/4' }, { value: 1, html: I18n.t(FULL_S) }],\n        step: true,\n        change(v) {\n          v = v === 0 ? 0.25 : v === 0.33 ? 0.5 : v === 0.66 ? 0.75 : 1;\n          player.danmaku.updateArea(v as any);\n        },\n      }, player));\n      panelElement.appendChild(rowElement);\n      rowElement = row();\n      rowElement.appendChild($(undefined, undefined, I18n.t(DANMAKU_S)));\n      this.speedSlider = addDisposable(this, new components.Slider(rowElement, {\n        stops: [{ value: 0, html: I18n.t(SLOW) }, { value: 1, html: I18n.t(FAST) }],\n        change(v) {\n          player.danmaku.updateSpeed(clamp(v + 0.5, 0.5, 1.5));\n        },\n      }, player));\n      panelElement.appendChild(rowElement);\n      rowElement = row();\n      rowElement.appendChild($(undefined, undefined, I18n.t(FONTSIZE)));\n      this.fontsizeSlider = addDisposable(this, new components.Slider(rowElement, {\n        stops: [{ value: 0, html: I18n.t(SMALL) }, { value: 1, html: I18n.t(BIG) }],\n        change(v) {\n          player.danmaku.updateFontsize(clamp(v + 0.5, 0.5, 1.5));\n        },\n      }, player));\n      panelElement.appendChild(rowElement);\n      rowElement = row();\n      this.unlimitedCB = addDisposable(this, new components.Checkbox(rowElement, {\n        html: I18n.t(UNLIMITED), change(v) { player.danmaku.updateUnlimited(v); },\n      }));\n      this.bottomUpCB = addDisposable(this, new components.Checkbox(rowElement, {\n        html: I18n.t(BOTTOM_TT), change(v) { player.danmaku.updateBottomUp(v); },\n      }));\n      panelElement.appendChild(rowElement);\n\n      this.update();\n    });\n  }\n\n  update() {\n    const opts = this.player.danmaku.opts;\n    this.scrollCB.update(opts.blocked.includes('scroll'));\n    this.topCB.update(opts.blocked.includes('top'));\n    this.bottomCB.update(opts.blocked.includes('bottom'));\n    this.colorCB.update(opts.blocked.includes('color'));\n    this.unlimitedCB.update(opts.unlimited);\n    this.bottomUpCB.update(opts.bottomUp);\n    this.opacitySlider.update(opts.opacity);\n    this.areaSlider.update({\n      0.25: 0, 0.5: 0.33, 0.75: 0.66, 1: 1,\n    }[opts.area]);\n    this.speedSlider.update(opts.speed - 0.5);\n    this.fontsizeSlider.update(opts.fontsizeScale - 0.5);\n  }\n\n  show = () => {\n    this.popover.show();\n    this.tooltip.hide();\n  }\n\n  dispose() {\n    if (!this.player) return;\n    this.player.Player._utils.dispose(this);\n    this.player.Player._utils.removeNode(this.element);\n    this.player = null!;\n  }\n}\n\nconst danmakuSettingControlItem = (player: Player) => new DanmakuSetting(player);\ndanmakuSettingControlItem.id = 'danmaku-setting';\nexport { danmakuSettingControlItem };\n","import type { Plugin as P, Player } from 'nplayer';\nimport { Danmaku, DanmakuOptions } from './danmaku';\nimport { danmakuSendBoxControlItem } from './send-box';\nimport { danmakuSettingControlItem } from './setting';\nimport { trans } from './utils';\n\nexport interface DanmakuPluginOption extends DanmakuOptions {\n  autoInsertControl: boolean;\n}\n\nexport class Plugin implements P {\n  private opts: DanmakuPluginOption;\n\n  constructor(opts: DanmakuPluginOption) {\n    this.opts = opts;\n  }\n\n  apply(player: Player) {\n    player.registerControlItem(danmakuSendBoxControlItem);\n    player.registerControlItem(danmakuSettingControlItem);\n\n    player.Player.I18n.add('zh-cn', trans);\n    player.danmaku = new Danmaku(player, this.opts);\n\n    if (this.opts && this.opts.autoInsertControl !== false) {\n      const i = player.opts.controls.findIndex((c) => c === 'spacer');\n      if (i > -1) {\n        player.opts.controls.splice(i, 1, 'danmaku', 'danmaku-setting');\n      } else {\n        player.opts.controls.push('danmaku', 'danmaku-setting');\n      }\n    }\n  }\n}\n","// Imports\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(function(i){return i[1]});\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".nplayer_danmaku_screen{bottom:0;left:0;overflow:hidden;pointer-events:none;position:absolute;right:0;top:0}.nplayer_danmaku_send{align-items:center;background:hsla(0,0%,100%,.15);display:flex;flex:1;font-size:0;margin:0 10px!important}.nplayer_danmaku_send input{background:transparent;border:0;color:currentColor;flex:1;outline:0;padding:0;width:100px}.nplayer_danmaku_send input::-moz-placeholder{color:hsla(0,0%,100%,.5)}.nplayer_danmaku_send input:-ms-input-placeholder{color:hsla(0,0%,100%,.5)}.nplayer_danmaku_send input::placeholder{color:hsla(0,0%,100%,.5)}.nplayer_danmaku_send_btn{cursor:pointer;font-size:12px;padding:0 10px;white-space:nowrap}.nplayer_danmaku_send .nplayer_popover_panel{padding:0 10px}.nplayer_danmaku_send .nplayer_checkbox{margin-top:3px}.nplayer_danmaku_send .nplayer_checkbox+.nplayer_checkbox{margin-left:8px}.nplayer_danmaku_colors{align-items:center;display:flex;flex-wrap:wrap}.nplayer_danmaku_color{translate:transform .2s ease;height:15px;margin-bottom:5px;margin-right:5px;width:15px}.nplayer_danmaku_color_row{align-items:stretch;display:flex;margin:5px 0}.nplayer_danmaku_color_row input{border:1px solid hsla(0,0%,100%,.8);flex:3;letter-spacing:1px;padding:0 5px;width:0}.nplayer_danmaku_color_preview{flex:2;height:20px;margin-left:5px}.nplayer_danmaku_color:hover{transform:scale(1.1)}.nplayer_danmaku_row{justify-content:space-between;margin:8px 0}.nplayer_danmaku_onoff_label{margin-right:5px;margin-top:-2px}.nplayer_danmaku_reset{border:1px solid hsla(0,0%,100%,.5);margin-left:auto;padding:2px 5px;transition:opacity .2s ease}.nplayer_danmaku_reset:hover{opacity:.7}.nplayer_danmaku_setting{padding:6px 8px}.nplayer_danmaku_setting .nplayer_slider{margin:3px 10px}.nplayer_danmaku_setting .nplayer_checkbox{margin-top:3px}.nplayer_danmaku_setting .nplayer_checkbox+.nplayer_checkbox{margin-left:8px}.nplayer_danmaku_item{color:#fff;letter-spacing:1px;line-height:1.125;position:absolute;text-shadow:#000 1px 0 1px,#000 0 1px 1px,#000 0 -1px 1px,#000 -1px 0 1px;white-space:nowrap;will-change:transform}.nplayer_danmaku_item-center{left:50%;transform:translateX(-50%);will-change:auto;z-index:1}.nplayer_danmaku_item-me{outline:2px solid;z-index:2}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === \"string\") {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, \"\"]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(400);\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"sourceRoot":""}